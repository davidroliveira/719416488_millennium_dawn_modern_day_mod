#Unlisted on_actions by haveabeard
#http://forum.paradoxplaza.com/forum/index.php?threads/list-of-currently-hardcoded-features-mechanics-etc-in-hoi4.957265/page-25#post-22275603
#on_military_access
#on_offer_military_access
#on_improve_relation
#on_guarantee
#on_non_aggression_pact
#on_call_allies
#on_join_allies
#on_declare_war
#on_create_faction
#on_join_faction
#on_offer_join_faction
#on_peace_proposal
#on_add_wargoal
#on_lend_lease
#on_incoming_lend_lease
#on_send_volunteers
#on_send_expeditionary_force
#on_return_expeditionary_forces
#on_request_expeditionary_forces
#on_generate_wargoal
#on_boost_party_popularity
#on_stage_coup
#on_leave_faction
#on_dismantle_faction
#on_ask_for_state_control
#on_give_state_control
#on_reduce_autonomy
#on_increase_autonomy

on_actions = {
	# country

	on_daily = {
	}

	#Timed pulses, four year and thri yearly pulses copied from EUIV, weekly and monthly from the top of my head, doesn't given an error at least?
	on_weekly = {
		effect = {
			##Influence Checks This is just to keep the influence arrays down and remove all non-existing nations
			recalculate_influence = yes
		}
	}
	on_monthly_SUD = {
		effect = {
			if = {
				limit = {
					NOT = {
						country_exists = SSU
						country_exists = AGF
					}
					NOT = {
						324 = {
							is_core_of = SSU
						}
					}
				}
				country_event = SouthSudan.1
			}
		}
	}
	on_monthly = {
		effect = {
			#Generic
			ai_update_build_units = yes
			#Possibility of domestic terror attack - civilian
			if = {
				limit = {
					is_in_array = { global.ct_states = THIS }
					no_jihadist_government = yes
					OR = {
						has_country_flag = threat_level_low
						has_country_flag = threat_level_moderate
						has_country_flag = threat_level_substantial
						has_country_flag = threat_level_severe
						has_country_flag = threat_level_critical
					}
				}
				random_list = {
					1 = { #terror attack planned
						random_list = {
							50 = { #foiled
								country_event = { id = terror.3 days = 15 random = 45 }
							}
							50 = { #not foiled
								random_list = {
									33 = {
										set_country_flag = government_targeted
										country_event = { id = terror.4 days = 30 random = 2400 }
									}
									33 = {
										set_country_flag = shia_targeted
										country_event = { id = terror.4 days = 30 random = 2400 }
									}
									33 = {
										set_country_flag = church_targeted
										country_event = { id = terror.4 days = 30 random = 2400 }
									}
								}
								modifier = {
									factor = 1.1
									has_idea = police_04
								}
								modifier = {
									factor = 1.2
									has_idea = police_03
								}
								modifier = {
									factor = 1.3
									has_idea = police_02
								}
								modifier = {
									factor = 1.4
									has_idea = police_01
								}
							}
						}
						modifier = {
							factor = 2
							has_country_flag = threat_level_moderate
						}
						modifier = {
							factor = 4
							has_country_flag = threat_level_substantial
						}
						modifier = {
							factor = 8
							has_country_flag = threat_level_severe
						}
						modifier = {
							factor = 16
							has_country_flag = threat_level_critical
						}
					}
					99 = {
					}
				}
			}
			#Possibility of domestic terror attack - military
			if = {
				limit = {
					is_in_array = { global.ct_states = THIS }
					no_jihadist_government = yes
					OR = {
						has_country_flag = threat_level_severe
						has_country_flag = threat_level_critical
					}
				}
				random_list = {
					1 = { #terror attack planned
						random_list = {
							50 = { #foiled
								country_event = { id = terror.3 days = 30 random = 2400 }
							}
							50 = { #not foiled
								country_event = { id = terror.5 days = 60 random = 2400 }
								modifier = {
									factor = 1.1
									has_idea = police_04
								}
								modifier = {
									factor = 1.2
									has_idea = police_03
								}
								modifier = {
									factor = 1.3
									has_idea = police_02
								}
								modifier = {
									factor = 1.4
									has_idea = police_01
								}
							}
						}
						modifier = {
							factor = 2
							has_country_flag = threat_level_severe
						}
						modifier = {
							factor = 4
							has_country_flag = threat_level_critical
						}
					}
					99 = {
					}
				}
			}
			#Possibility of international terror attack - civilian
			if = {
				limit = {
					is_in_array = { global.ct_states = THIS }
					no_jihadist_government = yes
					OR = {
						has_country_flag = threat_level_moderate
						has_country_flag = threat_level_substantial
						has_country_flag = threat_level_severe
						has_country_flag = threat_level_critical
					}
					is_full_state = yes
					any_country = {
						OR = {
							has_government = democratic
							has_government = communism
						}
						OR = {
							is_western_nation = yes
							is_East_Asia = yes
							original_tag = SOV
						}
						is_in_array = { ROOT.influence_array = THIS.id }
					}
				}
				random_list = {
					1 = { #terror attack planned
						random_list = {
							50 = { #foiled
								country_event = { id = terror.3 days = 15 random = 2400 }
							}
							50 = { #not foiled
								news_event = { id = terror.6 days = 30 random = 2400 }
								modifier = {
									factor = 1.1
									has_idea = police_04
								}
								modifier = {
									factor = 1.2
									has_idea = police_03
								}
								modifier = {
									factor = 1.3
									has_idea = police_02
								}
								modifier = {
									factor = 1.4
									has_idea = police_01
								}
							}
						}
						modifier = {
							factor = 1.5
							has_country_flag = threat_level_substantial
						}
						modifier = {
							factor = 2
							has_country_flag = threat_level_severe
						}
						modifier = {
							factor = 2.5
							has_country_flag = threat_level_critical
						}
					}
					99 = {
					}
				}
			}
			#Possibility of international terror attack - military
			if = {
				limit = {
					is_in_array = { global.ct_states = THIS }
					no_jihadist_government = yes
					OR = {
						has_country_flag = threat_level_severe
						has_country_flag = threat_level_critical
					}
					is_full_state = yes
					any_country = {
						OR = {
							has_government = democratic
							has_government = communism
						}
						is_full_state = yes
						has_military_access_to = ROOT
					}
				}
				random_list = {
					1 = { #terror attack planned
						random_list = {
							50 = { #foiled
								country_event = { id = terror.3 days = 30 random = 2400 }
							}
							50 = { #not foiled
								news_event = { id = terror.7 days = 60 random = 2400 }
								modifier = {
									factor = 1.1
									has_idea = police_04
								}
								modifier = {
									factor = 1.2
									has_idea = police_03
								}
								modifier = {
									factor = 1.3
									has_idea = police_02
								}
								modifier = {
									factor = 1.4
									has_idea = police_01
								}
							}
						}
						modifier = {
							factor = 2
							has_country_flag = threat_level_critical
						}
					}
					99 = {
					}
				}
			}
			#Possibility of jihadists crossing the border
			if = {
				limit = {
					OR = {
						has_country_flag = threat_level_severe
						has_country_flag = threat_level_critical
					}
				}
				every_neighbor_country = {
					limit = {
						NOT = { original_tag = USA }
						no_jihadist_government = yes
					}
					random_owned_state = {
						limit = {
							any_neighbor_state = {
								is_owned_by = ROOT
							}
							NOT = { state = 175 }
						}
						set_temp_variable = { temp1 = THIS }
					}
					random_list = {
						1 = {
							country_event = { id = terror.8 days = 45 random = 2400 }
							modifier = {
								factor = 5
								ROOT = { has_country_flag = threat_level_critical }
							}
							modifier = {
								factor = 0.5
								divisions_in_state = {
									size > 0
									state = temp1
								}
							}
							modifier = {
								factor = 0.5
								divisions_in_state = {
									size > 1
									state = temp1
								}
							}
							modifier = {
								factor = 0.5
								divisions_in_state = {
									size > 2
									state = temp1
								}
							}
							modifier = {
								factor = 0.5
								divisions_in_state = {
									size > 3
									state = temp1
								}
							}
							modifier = {
								factor = 0.5
								divisions_in_state = {
									size > 4
									state = temp1
								}
							}
						}
						99 = {
						}
					}
				}
			}
			#GCC
			if = {
				limit = {
					threat > 25
				}
				add_to_variable = { global.gcc_unity = 1 }
			}
			if = {
				limit = {
					threat > 50
				}
				add_to_variable = { global.gcc_unity = 2 }
			}
			if = {
				limit = {
					threat > 75
				}
				add_to_variable = { global.gcc_unity = 5 }
			}
			clamp_variable = {
				var = global.gcc_unity
				min = 0
				max = 100
			}
			#Chinese Aggression
			if = {
				limit = { check_variable = { chinese_aggression > 0 } }
				subtract_from_variable = { chinese_aggression = 1 }
			}
			#CT Training Decay
			if = {
				limit = {
					check_variable = { ct_training > 0 }
					is_in_array = { global.ct_states = THIS }
				}
				subtract_from_variable = { ct_training = 0.2 }
				clamp_variable = {
					var = ct_training
					min = 0
					max = 10
				}
			}
			#Radicalization increase
			if = {
				limit = {
					check_variable = { party_pop_array^11 > 0 }
					is_in_array = { global.ct_states = THIS }
				}
				country_event = { id = radicalization.8 }
			}
			if = {
				limit = {
					any_neighbor_country = {
						OR = {
							has_stability < 0.36
							is_target_of_coup = yes
							has_civil_war = yes
						}
					}
				}
				low_stability_init = yes
			}
			else_if = {
				limit = {
					all_neighbor_country = {
						OR = {
							has_stability > 0.35
							is_target_of_coup = no
							has_civil_war = no
						}
					}
				}
				update_unstable_neighbors = yes
				clr_country_flag = LS_neighbor_count
			}
			#check if influencer
			if = {
				limit = {
					any_other_country = {
						no_jihadist_government = yes
						is_top5_influencer = yes
						is_middle_eastern_nation = yes
						NOT = {
							original_tag = ISR
							original_tag = PER
							original_tag = PAL
							original_tag = HAM
							original_tag = HEZ
							original_tag = TUA
							original_tag = SHA
							is_Caucasus = yes
						}
					}
				}
				set_country_flag = middle_east_influencer
			}
			if = {
				limit = {
					NOT = {
						any_other_country = {
							no_jihadist_government = yes
							is_top5_influencer = yes
							is_middle_eastern_nation = yes
							NOT = {
								original_tag = ISR
								original_tag = PER
								original_tag = PAL
								original_tag = HAM
								original_tag = HEZ
								original_tag = TUA
								original_tag = SHA
								is_Caucasus = yes
							}
						}
					}
					has_country_flag = middle_east_influencer
				}
				clr_country_flag = middle_east_influencer
			}
			if = {
				limit = {
					any_other_country = {
						no_jihadist_government = yes
						is_top5_influencer = yes
						OR = {
							original_tag = BFA
							original_tag = CHA
							original_tag = MAL
							original_tag = MAU
							original_tag = NIG
							original_tag = NGR
							original_tag = SEN
							original_tag = SUD
							original_tag = SOM
						}
					}
				}
				set_country_flag = africa_influencer
			}
			if = {
				limit = {
					NOT = {
						any_other_country = {
							no_jihadist_government = yes
							is_top5_influencer = yes
							OR = {
								original_tag = BFA
								original_tag = CHA
								original_tag = MAL
								original_tag = MAU
								original_tag = NIG
								original_tag = NGR
								original_tag = SEN
								original_tag = SUD
								original_tag = SOM
							}
						}
					}
					has_country_flag = africa_influencer
				}
				clr_country_flag = africa_influencer
			}
			if = {
				limit = {
					any_other_country = {
						no_jihadist_government = yes
						is_top5_influencer = yes
						OR = {
							original_tag = AFG
							original_tag = KYR
							original_tag = TAJ
							original_tag = TRK
							original_tag = PAK
							original_tag = UZB
						}
					}
				}
				set_country_flag = asia_influencer
			}
			if = {
				limit = {
					NOT = {
						any_other_country = {
							no_jihadist_government = yes
							is_top5_influencer = yes
							OR = {
								original_tag = AFG
								original_tag = KYR
								original_tag = TAJ
								original_tag = TRK
								original_tag = PAK
								original_tag = UZB
							}
						}
					}
					has_country_flag = asia_influencer
				}
				clr_country_flag = asia_influencer
			}
		}
	}
	on_yearly = {
		effect = {
		}
	}
	on_thri_yearly_pulse = {
		effect = {
		}
	}

	on_bi_yearly_pulse = {
		effect = {
			every_country = {
				2017_state_init_setup = yes #updates all global state categories
			}
		}
		random_events = {
			100 = SyriaFocus.40
			100 = SyriaFocus.41
			100 = SyriaFocus.42
			100 = 0
		}
	}

	on_four_year_pulse = {

	}

	on_five_year_pulse = {

	}

	on_peace_proposal = {
		effect = {
		}
	}

	on_new_term_election = {

		random_events = {
			100 = taiwan.3

		}

		random_events = {
			100 = MD4_election_campaign.0

			#County specials
			1000 = election_SOV.1
		}
	}

	# Ace pilots
	# country, FROM = ace
	on_ace_promoted = {
		random_events = {
			100 = MD_ace_promoted.1
		}
	}

	# country, FROM = ace, PREV = enemy ace
	# This event fires twice, once for each ace.
	on_aces_killed_each_other = {
		random_events = {
			100 = MD_aces_killed_each_other.1
		}
	}

	# country, FROM = our ace,
	# PREV = enemy ace, has killed FROM
	on_ace_killed_by_ace = {
		random_events = {
			100 = MD_ace_killed_by_ace.1
		}
	}

	# country, FROM = our ace,
	# PREV = enemy ace, killed by FROM
	on_ace_killed_other_ace = {
		random_events = {
			100 = MD_ace_killed_other_ace.1
		}
	}

	# country, FROM = ace
	on_ace_killed = {
		random_events = {
			100 = MD_ace_died.1
		}
	}

	# During justifying wargoals
	# triggered daily, so make sure there is a sink somewhere not firing events
	# country, FROM = target nation
	on_justifying_wargoal_pulse = {
		random_events = {
			1000 = NATO.1
		}
		effect = {
			FROM = { ai_update_build_units = yes }
		}
	}

	on_wargoal_expire = {
		effect = {

		}
	}

	#FROM is state #ROOT is broken as hell
	on_nuke_drop = {
		effect = {
		}
	}

	on_border_war_lost = {
		effect = {

		}
	}

	on_leave_faction = {
		effect = {

		}
	}

	#FROM is the one that joins the faction
	on_create_faction = {

	}

	#FROM is country getting invited.
	on_offer_join_faction = {
		effect = {

		}
	}

	#FROM is faction leader on join faction requests.
	on_join_faction = {
		effect = {
			if = {
				limit = { FROM = { tag = CHI } }
				add_to_variable = { chinese_aggression = 1 }
			}
		}
	}

	# ROOT is capitulated country, FROM is winner
	on_capitulation = {
		effect = {
			news_event = { id = country_capitulated.0 days = 1 }

			#Fuck your shitty dynamic tag system pdx
			FROM = {
				if = {
					limit = {
						has_country_flag = dynamic_flag
						has_civil_war = yes
						NOT = {
							TAG = original_tag
							has_country_flag = is_civil_war_faction
						}
					}
					clr_country_flag = dynamic_flag
					clr_country_flag = dynamic_rebel_flag
					set_country_flag = fix_your_broken_dynamic_tags
					if = {
						limit = {
							OR = {
								is_in_array = { ruling_party = 0 }
								is_in_array = { ruling_party = 7 }
								is_in_array = { ruling_party = 13 }
								is_in_array = { ruling_party = 22 }
							}
						}
						meta_effect = {
							text = { set_cosmetic_tag = [ROOTTAG]_AUTH }
							ROOTTAG = "[?original_tag.GetTag]"
						}
					}
					else_if = {
						limit = {
							OR = {
								is_in_array = { ruling_party = 0 }
								is_in_array = { ruling_party = 7 }
								is_in_array = { ruling_party = 13 }
								is_in_array = { ruling_party = 22 }
							}
						}
						meta_effect = {
							text = { set_cosmetic_tag = [ROOTTAG]_AUTH_S }
							ROOTTAG = "[?original_tag.GetTag]"
						}
					}
					else_if = {
						limit = {
							OR = {
								is_in_array = { ruling_party = 4 }
								is_in_array = { ruling_party = 10 }
								is_in_array = { ruling_party = 19 }
								is_in_array = { ruling_party = 23 }
							}
						}
						meta_effect = {
							text = { set_cosmetic_tag = [ROOTTAG]_AUTH_S }
							ROOTTAG = "[?original_tag.GetTag]"
						}
					}
					else_if = {
						limit = {
							OR = {
								is_in_array = { ruling_party = 9 }
								is_in_array = { ruling_party = 11 }
								is_in_array = { ruling_party = 21 }
							}
						}
						meta_effect = {
							text = { set_cosmetic_tag = [ROOTTAG]_AUTH_SS }
							ROOTTAG = "[?original_tag.GetTag]"
						}
					}
					else = {
						set_cosmetic_tag = original_tag
					}
				}
			}

			#Special capitulation for ISIS
			if = {
				limit = {
					original_tag = ISI
					has_start_date > 2016.1.1
				}
				# Give Iraqi states first Kurdistan if they've capture them, otherwise return to Iraq
				every_owned_state = {
					limit = {
						is_core_of = IRQ
						is_controlled_by = KUR
					}
					KUR = {
						set_state_owner = PREV
					}
				}
				every_owned_state = {
					limit = {
						is_core_of = IRQ
					}
					IRQ = {
						set_state_owner = PREV
					}
				}
				# In Syria, give every non-capital state to its current controller
				every_owned_state = {
					limit = {
						is_core_of = SYR
					}
					controller = {
						transfer_state = PREV
					}
				}
				# Rest to the winner
				FROM = { annex_country = { target = ISI } }
			}
		}

	}

	#FROM is war target
	on_declare_war = {
		effect = {
			if = {
				limit = {
					#both in civil war
					ROOT = { original_tag = FROM }
					FROM = { NOT = { has_country_flag = no_leader_change } }
				}
				#assumes ROOT = civil war tag
				ROOT = {
					#Politics
					if = {
						limit = {
							NOT = { has_variable = ruling_party^0 }
						}
						start_politics_input = yes

						#copy politics
						for_loop_effect = {
							end = party_pop_array^num
							value = v
							set_variable = { party_pop_array^v = FROM.party_pop_array^v }
						}

						#realign with new outlook percentages
						add_up_party_totals = yes
						set_party_positions = yes

						#check FROM for flag to NOT set leader
						if = {
							limit = {
								NOT = { has_country_flag = no_leader_change }
							}
							set_failsafe_change_leader = yes
							startup_politics = yes
						}
					}
					#VARIABLES
					set_variable = { tax_rate = FROM.tax_rate }
					set_variable = { treasury = FROM.treasury }

					#don't get values of original yet - REMINDER -> add it on_civil_war_end
					set_variable = { debt = 0 }
					set_variable = { int_investments = 0 }

					#influence
					set_variable = { domestic_influence_amount = FROM.domestic_influence_amount }
					if = {
						limit = {check_variable = { domestic_influence_amount = 0 } }
						add_to_variable = { domestic_influence_amount = 100 }
					}
					#just copy all
					for_loop_effect = {
						end = FROM.influence_array^num
						value = v

						add_to_array = { influence_array = FROM.influence_array^v }
						add_to_array = { influence_array_val = FROM.influence_array_val^v }
					}
					recalculate_influence = yes

					#GAME VARIABLES
					add_political_power = FROM.political_power
					add_political_power = 400 #bonus

					#LAWS
					set_variable = { gdp_capita = FROM.gdp_capita }
					meta_effect = {
						text = {
							add_ideas = gdp_[GDP_LEVEL]
						}
						GDP_LEVEL = "[?gdp_capita|0]"
					}
					set_variable = { bureaucracy = FROM.bureaucracy }
					meta_effect = {
						text = {
							add_ideas = bureau_0[BUREAU_LEVEL]
						}
						BUREAU_LEVEL = "[?bureaucracy|0]"
					}
					set_variable = { crime_fighting = FROM.crime_fighting }
					meta_effect = {
						text = {
							add_ideas = police_0[POLICE_LEVEL]
						}
						POLICE_LEVEL = "[?crime_fighting|0]"
					}
					set_variable = { education_budget = FROM.education_budget }
					meta_effect = {
						text = {
							add_ideas = edu_0[EDU_LEVEL]
						}
						EDU_LEVEL = "[?education_budget|0]"
					}
					set_variable = { health_budget = FROM.health_budget }
					meta_effect = {
						text = {
							add_ideas = health_0[HEALTH_LEVEL]
						}
						HEALTH_LEVEL = "[?health_budget|0]"
					}
					set_variable = { social_budget = FROM.social_budget }
					meta_effect = {
						text = {
							add_ideas = social_0[WELFARE_LEVEL]
						}
						WELFARE_LEVEL = "[?social_budget|0]"
					}

					set_variable = { Military_Spending = FROM.Military_Spending }
					subtract_from_variable = { Military_Spending = 1 }
					meta_effect = {
						text = {
							add_ideas = defence_0[DEFENCE_LEVEL]
						}
						DEFENCE_LEVEL = "[?Military_Spending|0]"
					}
					set_variable = { Military_Spending = FROM.Military_Spending }

					set_variable = { economic_cycles = FROM.economic_cycles }
					if = { limit = { check_variable = { economic_cycles = 6 } }
						add_ideas = depression
					}
					else_if = { limit = { check_variable = { economic_cycles = 5 } }
						add_ideas = recession
					}
					else_if = { limit = { check_variable = { economic_cycles = 4 } }
						add_ideas = stagnation
					}
					else_if = { limit = { check_variable = { economic_cycles = 3 } }
						add_ideas = stable_growth
					}
					else_if = { limit = { check_variable = { economic_cycles = 2 } }
						add_ideas = fast_growth
					}
					else_if = { limit = { check_variable = { economic_cycles = 1 } }
						add_ideas = economic_boom
					}

					if = { limit = { FROM = { has_idea = paralyzing_corruption } }
						add_ideas = paralyzing_corruption
					}
					else_if = { limit = { FROM = { has_idea = crippling_corruption } }
						add_ideas = crippling_corruption
					}
					else_if = { limit = { FROM = { has_idea = rampant_corruption } }
						add_ideas = rampant_corruption
					}
					else_if = { limit = { FROM = { has_idea = unrestrained_corruption } }
						add_ideas = unrestrained_corruption
					}
					else_if = { limit = { FROM = { has_idea = systematic_corruption } }
						add_ideas = systematic_corruption
					}
					else_if = { limit = { FROM = { has_idea = widespread_corruption } }
						add_ideas = widespread_corruption
					}
					else_if = { limit = { FROM = { has_idea = medium_corruption } }
						add_ideas = medium_corruption
					}
					else_if = { limit = { FROM = { has_idea = modest_corruption } }
						add_ideas = modest_corruption
					}
					else_if = { limit = { FROM = { has_idea = slight_corruption } }
						add_ideas = slight_corruption
					}
					else_if = { limit = { FROM = { has_idea = negligible_corruption } }
						add_ideas = negligible_corruption
					}

					if = { limit = { FROM = { has_idea = consumption_economy } }
						add_ideas = consumption_economy
					}
					else_if = { limit = { FROM = { has_idea = mixed_economy } }
						add_ideas = mixed_economy
					}
					else_if = { limit = { FROM = { has_idea = export_economy } }
						add_ideas = export_economy
					}

					if = { limit = { FROM = { has_idea = no_military } }
						add_ideas = no_military
					}
					else_if = { limit = { FROM = { has_idea = volunteer_army } }
						add_ideas = volunteer_army
					}
					else_if = { limit = { FROM = { has_idea = partial_draft_army } }
						add_ideas = partial_draft_army
					}
					else_if = { limit = { FROM = { has_idea = draft_army } }
						add_ideas = draft_army
					}

					if = { limit = { FROM = { has_idea = no_women_in_military } }
						add_ideas = no_women_in_military
					}
					else_if = { limit = { FROM = { has_idea = volunteer_women } }
						add_ideas = volunteer_women
					}
					else_if = { limit = { FROM = { has_idea = drafted_women } }
						add_ideas = drafted_women
					}

					if = { limit = { FROM = { has_idea = intervention_isolation } }
						add_ideas = intervention_isolation
					}
					else_if = { limit = { FROM = { has_idea = intervention_local_security } }
						add_ideas = intervention_local_security
					}
					else_if = { limit = { FROM = { has_idea = intervention_limited_interventionism } }
						add_ideas = intervention_limited_interventionism
					}
					else_if = { limit = { FROM = { has_idea = intervention_regional_interventionism } }
						add_ideas = intervention_regional_interventionism
					}
					else_if = { limit = { FROM = { has_idea = intervention_global_interventionism } }
						add_ideas = intervention_global_interventionism
					}
					else_if = { limit = { FROM = { has_idea = intervention_neo_imperialism } }
						add_ideas = intervention_neo_imperialism
					}

					if = { limit = { FROM = { has_idea = officer_baptism_by_fire } }
						add_ideas = officer_baptism_by_fire
					}
					else_if = { limit = { FROM = { has_idea = officer_basic_training } }
						add_ideas = officer_basic_training
					}
					else_if = { limit = { FROM = { has_idea = officer_advanced_training } }
						add_ideas = officer_advanced_training
					}
					else_if = { limit = { FROM = { has_idea = officer_military_school } }
						add_ideas = officer_military_school
					}
					else_if = { limit = { FROM = { has_idea = officer_military_academy } }
						add_ideas = officer_military_academy
					}
					else_if = { limit = { FROM = { has_idea = officer_international_education } }
						add_ideas = officer_international_education
					}

					### Internal factions
					if = { limit = { FROM = { has_idea = small_medium_business_owners } }
						add_ideas = small_medium_business_owners
					}
					if = { limit = { FROM = { has_idea = international_bankers } }
						add_ideas = international_bankers
					}
					if = { limit = { FROM = { has_idea = fossil_fuel_industry } }
						add_ideas = fossil_fuel_industry
					}
					if = { limit = { FROM = { has_idea = industrial_conglomerates } }
						add_ideas = industrial_conglomerates
					}
					if = { limit = { FROM = { has_idea = oligarchs } }
						add_ideas = oligarchs
					}
					if = { limit = { FROM = { has_idea = maritime_industry } }
						add_ideas = maritime_industry
					}
					if = { limit = { FROM = { has_idea = defense_industry } }
						add_ideas = defense_industry
					}
					if = { limit = { FROM = { has_idea = the_military } }
						add_ideas = the_military
					}
					if = { limit = { FROM = { has_idea = intelligence_community } }
						add_ideas = intelligence_community
					}
					if = { limit = { FROM = { has_idea = labour_unions } }
						add_ideas = labour_unions
					}
					if = { limit = { FROM = { has_idea = landowners } }
						add_ideas = landowners
					}
					if = { limit = { FROM = { has_idea = farmers } }
						add_ideas = farmers
					}
					if = {
						limit = {
							FROM = {
								has_idea = communist_cadres
								ROOT = {
									OR = {
										is_in_array = { ruling_party = 4 }
										is_in_array = { ruling_party = 19 }
									}
								}
							}
						}
						add_ideas = communist_cadres
					}
					if = { limit = { FROM = { has_idea = the_priesthood } }
						add_ideas = the_priesthood
					}
					if = { limit = { FROM = { has_idea = The_Ulema } }
						add_ideas = The_Ulema
					}
					if = { limit = { FROM = { has_idea = The_Clergy } }
						add_ideas = The_Clergy
					}
					if = { limit = { FROM = { has_idea = wahabi_ulema } }
						add_ideas = wahabi_ulema
					}
					if = { limit = { FROM = { has_idea = the_donju } }
						add_ideas = the_donju
					}
					if = { limit = { FROM = { has_idea = the_bazaar } }
						add_ideas = the_bazaar
					}
					if = {
						limit = {
							FROM = {
								has_idea = saudi_royal_family
								ROOT = {
									OR = {
										is_in_array = { ruling_party = 10 }
										is_in_array = { ruling_party = 23 }
										is_in_array = { ruling_party = 0 }
									}
								}
							}
						}
						add_ideas = saudi_royal_family
					}
					if = {
						limit = {
							FROM = {
								has_idea = irgc
								ROOT = {
									NOT = {
										has_government = democratic
										has_government = fascism
									}
								}
							}
						}
						add_ideas = irgc
					}
					if = {
						limit = {
							FROM = {
								has_idea = iranian_quds_force
								ROOT = {
									NOT = {
										OR = {
											has_government = democratic
											has_government = fascism
										}
									}
								}
							}
						}
						add_ideas = iranian_quds_force
					}
					if = {
						limit = {
							FROM = {
								has_idea = vevak
								ROOT = {
									NOT = {
										has_government = democratic
										has_government = fascism
									}
								}
							}
						}
						add_ideas = vevak
					}
					if = {
						limit = {
							FROM = {
								has_idea = foreign_jihadis
								ROOT = {
									OR = {
										is_in_array = { ruling_party = 11 }
									}
								}
							}
						}
						add_ideas = foreign_jihadis
					}
					if = { limit = { FROM = { has_idea = isi_pakistan } }
						add_ideas = isi_pakistan
					}
					if = { limit = { FROM = { has_idea = wall_street } }
						add_ideas = wall_street
					}
					if = { limit = { FROM = { has_idea = chaebols } }
						add_ideas = chaebols
					}

					#copy leader throughput
					set_variable = { Western_Autocracy_leader = FROM.Western_Autocracy_leader?0 }
					set_variable = { conservatism_leader = FROM.conservatism_leader?0 }
					set_variable = { liberalism_leader = FROM.liberalism_leader?0 }
					set_variable = { socialism_leader = FROM.socialism_leader?0 }

					set_variable = { Communist-State_leader = FROM.Communist-State_leader?0 }
					set_variable = { anarchist_communism_leader = FROM.anarchist_communism_leader?0 }
					set_variable = { Conservative_leader = FROM.Conservative_leader?0 }
					set_variable = { Autocracy_leader = FROM.Autocracy_leader?0 }
					set_variable = { Mod_Vilayat_e_Faqih_leader = FROM.Mod_Vilayat_e_Faqih_leader?0 }
					set_variable = { Vilayat_e_Faqih_leader = FROM.Vilayat_e_Faqih_leader?0 }

					set_variable = { Kingdom_leader = FROM.Kingdom_leader?0 }
					set_variable = { Caliphate_leader = FROM.Caliphate_leader?0 }

					set_variable = { Neutral_Muslim_Brotherhood_leader = FROM.Neutral_Muslim_Brotherhood_leader?0 }
					set_variable = { Neutral_Autocracy_leader = FROM.Neutral_Autocracy_leader?0 }
					set_variable = { Neutral_conservatism_leader = FROM.Neutral_conservatism_leader?0 }
					set_variable = { oligarchism_leader = FROM.oligarchism_leader?0 }
					set_variable = { Neutral_Libertarian_leader = FROM.Neutral_Libertarian_leader?0 }
					set_variable = { Neutral_green_leader = FROM.Neutral_green_leader?0 }
					set_variable = { neutral_Social_leader = FROM.neutral_Social_leader?0 }
					set_variable = { Neutral_Communism_leader = FROM.Neutral_Communism_leader?0 }
					set_variable = { Nat_Populism_leader = FROM.Nat_Populism_leader?0 }
					set_variable = { Nat_Fascism_leader = FROM.Nat_Fascism_leader?0 }
					set_variable = { Nat_Autocracy_leader = FROM.Nat_Autocracy_leader?0 }
					set_variable = { Monarchist_leader = FROM.Monarchist_leader?0 }

					add_tax_laws = yes
					calculate_influence_percentage = yes #set alignment drifts from influence
					startup_extra_setup = yes 	#money system
					setup_init_factions = yes 	#flags for int. factions
					init_neighbor_drift_1 = yes #drift from neighbor
					init_neighbor_drift_2 = yes #drift from neighbor

					country_event = { id = brotherhood.0 } #Sets muslim_brotherhood relations
					country_event = { id = brotherhood.2 }

					#Recognition
					if = {
						limit = {
							NOT = {
								has_government = fascism
								FROM = { has_government = fascism }
							}
						}
						add_ideas = { rival_government }
						add_to_array = { global.rival_governments = THIS }
						set_country_flag = rival_government_@FROM
						FROM = {
							add_to_array = { global.rival_governments = THIS }
							set_country_flag = rival_government_@ROOT
							if = {
								limit = { has_start_date < 2016.01.01 }
								add_to_variable = {
									var = Granted_Recognition
									value = 188
								}
							}
							else_if = {
								limit = { has_start_date > 2016.01.01 }
								add_to_variable = {
									var = Granted_Recognition
									value = 193
								}
							}
						}
					}
					#Jihadist uprising
					if = {
						limit = {
							has_government = fascism
							NOT = { FROM = { has_cosmetic_tag = SAU_AQ } }
						}
						add_named_threat = {
							threat = 5
							name = terror.threat
						}
						add_ideas = Non_State_Actor
						if = {
							limit = { has_idea = saudi_royal_family }
							swap_ideas = {
								remove_idea = saudi_royal_family
								add_idea = foreign_jihadis
							}
							set_country_flag = positive_foreign_jihadis
						}
						if = {
							limit = { has_idea = the_military }
							swap_ideas = {
								remove_idea = the_military
								add_idea = foreign_jihadis
							}
							set_country_flag = positive_foreign_jihadis
						}
						every_other_country = {
							limit = { has_military_access_to = ROOT }
							diplomatic_relation = {
								country = ROOT
								relation = military_access
								active = no
							}
						}
						every_other_country = {
							limit = { has_guaranteed = ROOT }
							diplomatic_relation = {
								country = ROOT
								relation = guarantee
								active = no
							}
						}
						if = {
							limit = { is_in_faction = yes }
							leave_faction = yes
						}
						set_political_party = {
							ideology = fascism
							popularity = 100
						}
						set_variable = { party_pop_array^11 = 1 }
						recalculate_party = yes
						clear_array = ruling_party
						clear_array = gov_coalition_array
						add_to_array = { ruling_party = 11 }
						update_government_coalition_strength = yes
						update_party_name = yes
						set_coalition_drift = yes
						meta_effect = {
							text = {
								set_country_flag = [META_SET_RULING_PARTY]
							}
							META_SET_RULING_PARTY = "[meta_set_ruling_leader]"
						}
						set_leader = yes
						#Influence system
						init_influence = yes
						set_variable = { domestic_influence_amount = 200 }
						startup_influence = yes
						FROM = { set_country_flag = fighting_jihadis }
						if = {
							limit = { country_exists = AQY }
							remove_opinion_modifier = {
								target = AQY
								modifier = AlQaida_Are_Terrorists
							}
							remove_opinion_modifier = {
								target = AQY
								modifier = AlQaida_Are_Terrorists_Trade
							}
						}
						if = {
							limit = { country_exists = TAL }
							remove_opinion_modifier = {
								target = TAL
								modifier = AlQaida_Are_Terrorists
							}
							remove_opinion_modifier = {
								target = TAL
								modifier = AlQaida_Are_Terrorists_Trade
							}
						}
						if = {
							limit = { country_exists = TTP }
							remove_opinion_modifier = {
								target = TTP
								modifier = AlQaida_Are_Terrorists
							}
							remove_opinion_modifier = {
								target = TTP
								modifier = AlQaida_Are_Terrorists_Trade
							}
						}
						every_country = {
							limit = { no_jihadist_government = yes }
							add_opinion_modifier = {
								target = ROOT
								modifier = terrorism_is_no_no
							}
							add_opinion_modifier = {
								target = ROOT
								modifier = terrorism_is_no_no_trade
							}
							add_ai_strategy = { type = befriend id = ROOT value = -200 }
							add_ai_strategy = { type = support id = ROOT value = -200 }
							add_ai_strategy = { type = protect id = ROOT value = -200 }
							add_ai_strategy = { type = send_volunteers_desire id = ROOT value = -200 }
							add_ai_strategy = { type = contain id = ROOT value = 200 }
							add_ai_strategy = { type = antagonize id = ROOT value = 200 }
							add_ai_strategy = { type = conquer id = ROOT value = 200 }
						}
						add_ideas = intervention_neo_imperialism
						add_equipment_to_stockpile = {
							type = infantry_weapons
							amount = 2000
							producer = SOV
						}
						set_variable = { radicalization = 100 }
						set_variable = { social_conservatism_government = 100 }
						set_variable = { social_conservatism_society = 100 }
						if = {
							limit = { original_tag = SUD }
							if = {
								limit = { SUD = { has_war_with = SSU }}
								declare_war_on = {
									target = SSU
									type = annex_everything
								}
							}
							if = {
								limit = { SUD = { has_war_with = SRF }}
								declare_war_on = {
									target = SRF
									type = annex_everything
								}
							}
							if = {
								limit = { SUD = { has_war_with = DAR }}
								declare_war_on = {
									target = DAR
									type = annex_everything
								}
							}
						}
						if = {
							limit = { original_tag = SYR }
							if = {
								limit = { country_exists = FSA }
								declare_war_on = {
									target = FSA
									type = annex_everything
								}
							}
							if = {
								limit = { country_exists = ROJ }
								declare_war_on = {
									target = ROJ
									type = annex_everything
								}
							}
						}
						if = {
							limit = { original_tag = FSA }
							if = {
								limit = { country_exists = SYR }
								declare_war_on = {
									target = SYR
									type = annex_everything
								}
							}
							if = {
								limit = { country_exists = ROJ }
								declare_war_on = {
									target = ROJ
									type = annex_everything
								}
							}
						}
						if = {
							limit = { original_tag = IRQ }
							if = {
								limit = { country_exists = KUR }
								declare_war_on = {
									target = KUR
									type = annex_everything
								}
							}
						}
						if = {
							limit = { original_tag = GNA }
							if = {
								limit = { country_exists = GNC }
								declare_war_on = {
									target = GNC
									type = annex_everything
								}
							}
							if = {
								limit = { country_exists = HOR }
								declare_war_on = {
									target = HOR
									type = annex_everything
								}
							}
							if = {
								limit = { country_exists = TUA }
								declare_war_on = {
									target = TUA
									type = annex_everything
								}
							}
						}
						if = {
							limit = { original_tag = GNC }
							if = {
								limit = { country_exists = GNA }
								declare_war_on = {
									target = GNA
									type = annex_everything
								}
							}
							if = {
								limit = { country_exists = HOR }
								declare_war_on = {
									target = HOR
									type = annex_everything
								}
							}
							if = {
								limit = { country_exists = TUA }
								declare_war_on = {
									target = TUA
									type = annex_everything
								}
							}
						}
						if = {
							limit = { original_tag = HOR }
							if = {
								limit = { country_exists = GNC }
								declare_war_on = {
									target = GNC
									type = annex_everything
								}
							}
							if = {
								limit = { country_exists = GNA }
								declare_war_on = {
									target = GNA
									type = annex_everything
								}
							}
							if = {
								limit = { country_exists = TUA }
								declare_war_on = {
									target = TUA
									type = annex_everything
								}
							}
						}
						if = {
							limit = { original_tag = YEM }
							if = {
								limit = { country_exists = HOU }
								declare_war_on = {
									target = HOU
									type = annex_everything
								}
							}
						}
						if = {
							limit = {
								original_tag = AFG
							}
							TAL = {
								annex_country = {
									target = ROOT
									transfer_troops = yes
								}
								declare_war_on = {
									target = FROM
									type = annex_everything
								}
								every_state = {
									limit = { is_core_of = FROM }
									add_core_of = TAL
								}
								every_country = {
									limit = { no_jihadist_government = yes }
									add_opinion_modifier = {
										target = ROOT
										modifier = terrorism_is_no_no
									}
									add_opinion_modifier = {
										target = ROOT
										modifier = terrorism_is_no_no_trade
									}
									add_ai_strategy = { type = befriend id = ROOT value = -200 }
									add_ai_strategy = { type = support id = ROOT value = -200 }
									add_ai_strategy = { type = protect id = ROOT value = -200 }
									add_ai_strategy = { type = send_volunteers_desire id = ROOT value = -200 }
									add_ai_strategy = { type = contain id = ROOT value = 200 }
									add_ai_strategy = { type = antagonize id = ROOT value = 200 }
									add_ai_strategy = { type = conquer id = ROOT value = 200 }
								}
								add_ideas = intervention_neo_imperialism
							}
						}
						if = {
							limit = {
								original_tag = SOM
							}
							SHB = {
								annex_country = {
									target = ROOT
									transfer_troops = yes
								}
								declare_war_on = {
									target = FROM
									type = annex_everything
								}
								if = {
									limit = { country_exists = SNA }
									declare_war_on = {
										target = SNA
										type = annex_everything
									}
								}
								if = {
									limit = { country_exists = JUB }
									declare_war_on = {
										target = JUB
										type = annex_everything
									}
								}
								if = {
									limit = { country_exists = SWS }
									declare_war_on = {
										target = SWS
										type = annex_everything
									}
								}
								every_state = {
									limit = { is_core_of = FROM }
									add_core_of = SHB
								}
								every_country = {
									limit = { no_jihadist_government = yes }
									add_opinion_modifier = {
										target = ROOT
										modifier = terrorism_is_no_no
									}
									add_opinion_modifier = {
										target = ROOT
										modifier = terrorism_is_no_no_trade
									}
									add_ai_strategy = { type = befriend id = ROOT value = -200 }
									add_ai_strategy = { type = support id = ROOT value = -200 }
									add_ai_strategy = { type = protect id = ROOT value = -200 }
									add_ai_strategy = { type = send_volunteers_desire id = ROOT value = -200 }
									add_ai_strategy = { type = contain id = ROOT value = 200 }
									add_ai_strategy = { type = antagonize id = ROOT value = 200 }
									add_ai_strategy = { type = conquer id = ROOT value = 200 }
								}
								add_ideas = intervention_neo_imperialism
							}
						}
						if = {
							limit = {
								OR = {
									country_exists = ISI
									has_start_date > 2016.01.01
								}
								OR = {
									original_tag = IRQ
									original_tag = SYR
									original_tag = LEB
									original_tag = TUR
									original_tag = JOR
									original_tag = FSA
									original_tag = KUR
									original_tag = ROJ
									original_tag = GNA
									original_tag = GNC
									original_tag = HOR
									original_tag = EGY
									original_tag = TUN
								}
							}
							ISI = {
								annex_country = {
									target = ROOT
									transfer_troops = yes
								}
								declare_war_on = {
									target = FROM
									type = annex_everything
								}
								every_state = {
									limit = { is_core_of = FROM }
									add_core_of = ISI
								}
								if = {
									limit = { PREV = { original_tag = SYR } }
									if = {
										limit = { country_exists = FSA }
										declare_war_on = {
											target = FSA
											type = annex_everything
										}
									}
									if = {
										limit = { country_exists = ROJ }
										declare_war_on = {
											target = ROJ
											type = annex_everything
										}
									}
								}
								if = {
									limit = { PREV = { original_tag = FSA } }
									if = {
										limit = { country_exists = SYR }
										declare_war_on = {
											target = SYR
											type = annex_everything
										}
									}
									if = {
										limit = { country_exists = ROJ }
										declare_war_on = {
											target = ROJ
											type = annex_everything
										}
									}
								}
								if = {
									limit = { PREV = { original_tag = IRQ } }
									if = {
										limit = { country_exists = KUR }
										declare_war_on = {
											target = KUR
											type = annex_everything
										}
									}
								}
								if = {
									limit = { PREV = { original_tag = GNA } }
									if = {
										limit = { country_exists = GNC }
										declare_war_on = {
											target = GNC
											type = annex_everything
										}
									}
									if = {
										limit = { country_exists = HOR }
										declare_war_on = {
											target = HOR
											type = annex_everything
										}
									}
								}
								if = {
									limit = { PREV = { original_tag = GNC } }
									if = {
										limit = { country_exists = GNA }
										declare_war_on = {
											target = GNA
											type = annex_everything
										}
									}
									if = {
										limit = { country_exists = HOR }
										declare_war_on = {
											target = HOR
											type = annex_everything
										}
									}
								}
								if = {
									limit = { PREV = { original_tag = HOR } }
									if = {
										limit = { country_exists = GNC }
										declare_war_on = {
											target = GNC
											type = annex_everything
										}
									}
									if = {
										limit = { country_exists = GNA }
										declare_war_on = {
											target = GNA
											type = annex_everything
										}
									}
									if = {
										limit = { country_exists = TUA }
										declare_war_on = {
											target = TUA
											type = annex_everything
										}
									}
								}
								if = {
									limit = { PREV = { original_tag = YEM } }
									if = {
										limit = { country_exists = HOU }
										declare_war_on = {
											target = HOU
											type = annex_everything
										}
									}
								}
								every_country = {
									limit = { no_jihadist_government = yes }
									add_opinion_modifier = {
										target = ROOT
										modifier = terrorism_is_no_no
									}
									add_opinion_modifier = {
										target = ROOT
										modifier = terrorism_is_no_no_trade
									}
									add_ai_strategy = { type = befriend id = ROOT value = -200 }
									add_ai_strategy = { type = support id = ROOT value = -200 }
									add_ai_strategy = { type = protect id = ROOT value = -200 }
									add_ai_strategy = { type = send_volunteers_desire id = ROOT value = -200 }
									add_ai_strategy = { type = contain id = ROOT value = 200 }
									add_ai_strategy = { type = antagonize id = ROOT value = 200 }
									add_ai_strategy = { type = conquer id = ROOT value = 200 }
								}
								add_ideas = intervention_neo_imperialism
							}
						}
						if = {
							limit = { FROM = { has_government = fascism }}
							set_cosmetic_tag = SAU_AQ
						}
					}
					FROM = {
						if = {
							limit = {
								has_government = fascism
								if = {
									limit = { ROOT = { has_government = fascism }}
									has_cosmetic_tag = SAU_AQ
								}
							}
							ROOT = { set_country_flag = fighting_jihadis }
							add_named_threat = {
								threat = 5
								name = terror.threat
							}
							add_ideas = Non_State_Actor
							if = {
								limit = { has_idea = saudi_royal_family }
								swap_ideas = {
									remove_idea = saudi_royal_family
									add_idea = foreign_jihadis
								}
								set_country_flag = positive_foreign_jihadis
							}
							if = {
								limit = { has_idea = the_military }
								swap_ideas = {
									remove_idea = the_military
									add_idea = foreign_jihadis
								}
								set_country_flag = positive_foreign_jihadis
							}
							every_other_country = {
								limit = { has_military_access_to = FROM }
								diplomatic_relation = {
									country = FROM
									relation = military_access
									active = no
								}
							}
							every_other_country = {
								limit = { has_guaranteed = ROOT }
								diplomatic_relation = {
									country = ROOT
									relation = guarantee
									active = no
								}
							}
							if = {
								limit = { is_in_faction = yes }
								leave_faction = yes
							}
							set_political_party = {
								ideology = fascism
								popularity = 100
							}
							set_variable = { party_pop_array^11 = 1 }
							recalculate_party = yes
							clear_array = ruling_party
							clear_array = gov_coalition_array
							add_to_array = { ruling_party = 11 }
							update_government_coalition_strength = yes
							update_party_name = yes
							set_coalition_drift = yes
							meta_effect = {
								text = {
									set_country_flag = [META_SET_RULING_PARTY]
								}
								META_SET_RULING_PARTY = "[meta_set_ruling_leader]"
							}
							set_leader = yes
							#Influence system
							init_influence = yes
							set_variable = { domestic_influence_amount = 200 }
							startup_influence = yes
							if = {
								limit = { country_exists = AQY }
								remove_opinion_modifier = {
									target = AQY
									modifier = AlQaida_Are_Terrorists
								}
								remove_opinion_modifier = {
									target = AQY
									modifier = AlQaida_Are_Terrorists_Trade
								}
							}
							if = {
								limit = { country_exists = TAL }
								remove_opinion_modifier = {
									target = TAL
									modifier = AlQaida_Are_Terrorists
								}
								remove_opinion_modifier = {
									target = TAL
									modifier = AlQaida_Are_Terrorists_Trade
								}
							}
							if = {
								limit = { country_exists = TTP }
								remove_opinion_modifier = {
									target = TTP
									modifier = AlQaida_Are_Terrorists
								}
								remove_opinion_modifier = {
									target = TTP
									modifier = AlQaida_Are_Terrorists_Trade
								}
							}
							every_country = {
								limit = { no_jihadist_government = yes }
								add_opinion_modifier = {
									target = FROM
									modifier = terrorism_is_no_no
								}
								add_opinion_modifier = {
									target = FROM
									modifier = terrorism_is_no_no_trade
								}
								add_ai_strategy = { type = befriend id = FROM value = -200 }
								add_ai_strategy = { type = support id = FROM value = -200 }
								add_ai_strategy = { type = protect id = FROM value = -200 }
								add_ai_strategy = { type = send_volunteers_desire id = FROM value = -200 }
								add_ai_strategy = { type = contain id = FROM value = 200 }
								add_ai_strategy = { type = antagonize id = FROM value = 200 }
								add_ai_strategy = { type = conquer id = FROM value = 200 }
							}
							add_ideas = intervention_neo_imperialism
							add_equipment_to_stockpile = {
								type = infantry_weapons
								amount = 2000
								producer = SOV
							}
							set_variable = { radicalization = 100 }
							set_variable = { social_conservatism_government = 100 }
							set_variable = { social_conservatism_society = 100 }
							if = {
								limit = { original_tag = SYR }
								if = {
									limit = { country_exists = FSA }
									declare_war_on = {
										target = FSA
										type = annex_everything
									}
								}
								if = {
									limit = { country_exists = ROJ }
									declare_war_on = {
										target = ROJ
										type = annex_everything
									}
								}
							}
							if = {
								limit = { original_tag = FSA }
								if = {
									limit = { country_exists = SYR }
									declare_war_on = {
										target = SYR
										type = annex_everything
									}
								}
								if = {
									limit = { country_exists = ROJ }
									declare_war_on = {
										target = ROJ
										type = annex_everything
									}
								}
							}
							if = {
								limit = { original_tag = IRQ }
								if = {
									limit = { country_exists = KUR }
									declare_war_on = {
										target = KUR
										type = annex_everything
									}
								}
							}
							if = {
								limit = { original_tag = GNA }
								if = {
									limit = { country_exists = GNC }
									declare_war_on = {
										target = GNC
										type = annex_everything
									}
								}
								if = {
									limit = { country_exists = HOR }
									declare_war_on = {
										target = HOR
										type = annex_everything
									}
								}
							}
							if = {
								limit = { original_tag = GNC }
								if = {
									limit = { country_exists = GNA }
									declare_war_on = {
										target = GNA
										type = annex_everything
									}
								}
								if = {
									limit = { country_exists = HOR }
									declare_war_on = {
										target = HOR
										type = annex_everything
									}
								}
							}
							if = {
								limit = { original_tag = HOR }
								if = {
									limit = { country_exists = GNC }
									declare_war_on = {
										target = GNC
										type = annex_everything
									}
								}
								if = {
									limit = { country_exists = GNA }
									declare_war_on = {
										target = GNA
										type = annex_everything
									}
								}
								if = {
									limit = { country_exists = TUA }
									declare_war_on = {
										target = TUA
										type = annex_everything
									}
								}
							}
							if = {
								limit = { original_tag = YEM }
								if = {
									limit = { country_exists = HOU }
									declare_war_on = {
										target = HOU
										type = annex_everything
									}
								}
							}
						}
					}
				}
			}
			hidden_effect = {
				FROM = {
					update_military_rate = yes
					every_neighbor_country = { country_event = low_stability.4 }
				}
				ROOT = {
					update_military_rate = yes
					every_neighbor_country = { country_event = low_stability.4 }
				}
				log = "FROM IS [From.GetName] hello"
				log = "ROOT IS [ROOT.GetName] hello"
			}

			#NATO
			if = {
				limit = {
					FROM = { has_idea = NATO_member }
					NOT = { ROOT = { original_tag = FROM } }
				}
				custom_effect_tooltip = TT_CALL_NATO
				if = {
					limit = {
						NOT = { has_global_flag = NATO_called_to_arms }
					}
					FROM = { country_event = NATO.2 }
				}
				set_country_flag = Attacked_NATO
			}

			#Rio Pact
			if = {
				limit = {
					FROM = {
						has_idea = rio_pact_member
					}
					NOT = { ROOT = { original_tag = FROM } }
					ROOT = {
						NOT = {
							tag = ISI
							tag = TAL
							tag = TTP
							tag = NUS
							tag = AQY
							has_country_flag = terrorist_group
						}
					}
				}
				custom_effect_tooltip = TT_RIO_PACT
				hidden_effect = {
					FROM = { country_event = { id = rio_pact_event.1 } }
				}
				ROOT = { country_event = { id =  rio_pact_event.3 days = 20 } }
			}

			#Chinese aggression increase
			if = {
				limit = { ROOT = { tag = CHI } }
				add_to_variable = { chinese_aggression = 10 }
			}
		}
	}

	#Ask for Mil access - FROM is target country
	on_military_access = {
		effect = {
			FROM = {
				country_event = { id = projection.1 }
			}
			add_to_variable = { power_projection = 1 }
			if = {
				limit = {
					NOT = {
						has_idea = limited_power_projection
						has_idea = significant_power_projection
						has_idea = massive_power_projection
					}
				}
				add_ideas = limited_power_projection
			}
			if = {
				limit = {
					check_variable = { power_projection > 9 }
					has_idea = limited_power_projection
				}
				swap_ideas = {
					remove_idea = limited_power_projection
					add_idea = significant_power_projection
				}
			}
			else_if = {
				limit = {
					check_variable = { power_projection > 29 }
					has_idea = significant_power_projection
				}
				swap_ideas = {
					remove_idea = significant_power_projection
					add_idea = massive_power_projection
				}
			}
			if = {
				limit = { ROOT = { tag = CHI } }
				add_to_variable = { chinese_aggression = 1 }
			}
		}
	}

	#offer for Mil access to your country - From is target country
	on_offer_military_access = {
		effect = {
		}
	}
	#try on_revoke_guarantee

	# When a new faction is formed
	on_faction_formed = {
		effect = {
		}
	}
	#From is
	on_stage_coup = {
		effect = {
			FROM = {
				every_neighbor_country = { country_event = low_stability.3 }
			}
		}
	}

	on_coup_succeeded = {
		effect = {
			ROOT = {
				country_event = { id = init.2 }
			}
		}
	}

	#ROOT is winner #FROM gets annexed
	on_civil_war_end = {
		effect = {
			ROOT = {

				if = {
					limit = {
						check_variable = { debt < FROM.debt } #less than
					}
					add_to_variable = { debt = FROM.debt }
				}
				if = {
					limit = {
						check_variable = { int_investments < FROM.int_investments } #less than
					}
					add_to_variable = { int_investments = FROM.int_investments }
				}
				if = {
					limit = {
						is_in_array = { ruling_party = 0 }
					}
					set_politics = {
						ruling_party = democratic
						elections_allowed = no
					}
				}
				else_if = {
					limit = {
						OR = {
							is_in_array = { ruling_party = 1 }
							is_in_array = { ruling_party = 2 }
							is_in_array = { ruling_party = 3 }
						}
					}
					set_politics = {
						ruling_party = democratic
						elections_allowed = yes
					}
				}
				else_if = {
					limit = {
						OR = {
							is_in_array = { ruling_party = 4 }
							is_in_array = { ruling_party = 7 }
							is_in_array = { ruling_party = 9 }
						}
					}
					set_politics = {
						ruling_party = communism
						elections_allowed = no
					}
				}
				else_if = {
					limit = {
						OR = {
							is_in_array = { ruling_party = 5 }
							is_in_array = { ruling_party = 6 }
							is_in_array = { ruling_party = 8 }
						}
					}
					set_politics = {
						ruling_party = communism
						elections_allowed = yes
					}
				}
				else_if = {
					limit = {
						OR = {
							is_in_array = { ruling_party = 10 }
							is_in_array = { ruling_party = 11 }
						}
					}
					set_politics = {
						ruling_party = fascism
						elections_allowed = no
					}
				}
				else_if = {
					limit = {
						OR = {
							is_in_array = { ruling_party = 13 }
							is_in_array = { ruling_party = 19 }
						}
					}
					set_politics = {
						ruling_party = neutrality
						elections_allowed = no
					}
				}
				else_if = {
					limit = {
						OR = {
							is_in_array = { ruling_party = 12 }
							is_in_array = { ruling_party = 14 }
							is_in_array = { ruling_party = 15 }
							is_in_array = { ruling_party = 16 }
							is_in_array = { ruling_party = 17 }
							is_in_array = { ruling_party = 18 }
						}
					}
					set_politics = {
						ruling_party = neutrality
						elections_allowed = yes
					}
				}
				else_if = {
					limit = {
						OR = {
							is_in_array = { ruling_party = 21 }
							is_in_array = { ruling_party = 22 }
							is_in_array = { ruling_party = 23 }
						}
					}
					set_politics = {
						ruling_party = nationalist
						elections_allowed = no
					}
				}
				else_if = {
					limit = {
						is_in_array = { ruling_party = 20 }
					}
					set_politics = {
						ruling_party = nationalist
						elections_allowed = yes
					}
				}
				#Recognition
				remove_ideas = rival_government
				remove_from_array = { global.rival_governments = THIS }
				clr_country_flag = rival_government_@FROM
				#CT
				if = {
					limit = { is_in_array = { global.ct_states = THIS }}
					subtract_from_variable = { threat_level = 30 }
					clamp_threat = yes
				}
			}
		}
	}

	on_guarantee = {
	}

	on_improve_relation = {
	}

	on_startup = {
		effect = {
			log = "[GetDateText]: [This.GetName]: on_startup init begun"
			#Fixing war between a bunch of countries because raisins

			LIB = { if = { limit = { NOT = { country_exists = LUR } } white_peace = GUI white_peace = SIE } }
			DRC = { if = { limit = { NOT = { country_exists = MLC } } white_peace = UGA white_peace = RWA } }
			LIB = { set_law_attitudes = yes } #any country will do
			#Set correct focus tree for Syria
			SYR = {
				if = {
					limit = { has_start_date < 2016.1.1 }
					load_focus_tree = Syria_2000
				}
				else = {
					load_focus_tree = Syria_Focus_2017
				}
			}

			ITA = {
				if = {
					limit = {
						is_ai = no
					}
					country_event = italy_md.23
				}
				resize_array = {
  					array = abandon_coalition_threshold
 					size = 24
				}
				calculate_abandon_coalition_threshold = yes
			}

			every_country = {
				add_tax_laws = yes
				calculate_influence_percentage = yes #set alignment drifts from influence
				startup_politics = yes
				startup_extra_setup = yes 	#money system
				setup_init_factions = yes 	#flags for int. factions
				set_law_vars = yes 	#vars for change laws secondary effects
				init_neighbor_drift_1 = yes #drift from neighbor
				init_neighbor_drift_2 = yes #drift from neighbor
				ai_update_build_units = yes

				country_event = { id = brotherhood.0 } #Sets muslim_brotherhood relations
				country_event = { id = brotherhood.2 }
				set_country_flag = { flag = total_AB_wars value = 0 }

				if = {
					limit = { is_ai = no } country_event = { id = init.0 } #has no effects except startup text
				}
				else = {
					give_AI_templates = yes
				}

				set_variable = { AC_build_amount = 1 }
				set_variable = { AC_build_cost = 0 }
				if = { #Set NATO tech sharing
					limit = { has_dlc = "Together for Victory" }
					every_country = { limit = { has_idea = NATO_member } add_to_tech_sharing_group = NATO_Tech_Share }
				}
				if = {
					limit = { has_start_date > 2016.1.1 }		#2017 state category update
					2017_state_init_setup = yes
				}
				if = {
					limit = { has_stability < 0.36 }
					low_stability_init = yes
				}
			}

			random_country = {
				if = {
					limit = { has_start_date < 2001.1.1 }		#2000 relations
					country_event = { id = init_relations.1 }
				}
				if = {
					limit = { has_start_date > 2016.1.1 }		#2017 relations
					country_event = { id = init_relations.0 }
				}
			}

			USA = {
				country_event = { id = usa_vanilla.50 days = 5 }
				country_event = { id = usa_vanilla.51 days = 5 }
				country_event = { id = usa.1000 days = 120 random = 20  }
				if = {
					limit = { has_start_date < 2016.1.1 }
					country_event = { id = usa.6 days = 90 random = 70 }
					country_event = { id = usa.7 days = 1 }
					country_event = { id = usa.8 days = 390 random = 10 }
					country_event = { id = usa.9 days = 25 random = 10 }
					country_event = { id = usa.53 days = 3 random = 2 }
				}
				if = {
					limit = { has_start_date > 2016.1.1 }
					country_event = { id = donald_trump.1000 days = 1 }
					country_event = { id = donald_trump.1001 days = 19 }
					country_event = { id = donald_trump.1002 days = 50 random = 10 }
				}
				#9/11
				if = {
					limit = { has_start_date < 2001.1.1 }
					country_event = { id = wot.1 days = 450 random = 8760 }
				}
			}
			CAN = {
				CAN_update_french_happiness = yes
			}
			CHI = {
				if = {
					limit = {
						AND = {
							has_start_date < 2001.1.1
							has_dlc = "Man the Guns"
						}
					}
					country_event = { id = china.63 days = 430 }
				}
			}
			AFG = {
				if = {
					limit = { has_start_date < 2001.1.1 }
					country_event = { id = Afghanistan.3 days = 635 random = 1440 }
				}
			}
			SYR = {
				if = {
					limit = { has_start_date < 2001.1.1 }
					country_event = { id = SyriaFocus.39 days = 150 random = 8760 }
				}
			}
			SAU = {
				if = {
					limit = { has_start_date < 2001.1.1 }
					news_event = { id = saudi_royal.1 days = 2039 } #death of King Fahd
				}
			}
			UAE = {
				if = {
					limit = { has_start_date < 2001.1.1 }
					news_event = { id = uae_royal.1 days = 1767 } #death of Sheikh Zayed
				}
			}
			KUW = {
				if = {
					limit = { has_start_date < 2001.1.1 }
					news_event = { id = kuwait_royal.1 days = 2206 } #death of Sheikh Jaber
				}
			}

			#power projection setup
			every_country = {
				country_event = { id = projection.1 }
			}

			#Arab Spring
			every_country = {
				limit = {
					if = {
						limit = { has_start_date > 2016.01.01 }
						NOT = {
							original_tag = GNA
							original_tag = GNC
							original_tag = HOR
							original_tag = SYR
							original_tag = EGY
							original_tag = TUN
						}
					}
					NOT = { original_tag = HEZ }
					is_arabic_nation = yes
				}
				country_event = { id = arab_spring.16 }
			}
			#check if influencer
			every_country = {
				if = {
					limit = {
						any_other_country = {
							no_jihadist_government = yes
							is_top5_influencer = yes
							is_middle_eastern_nation = yes
							NOT = {
								original_tag = ISR
								original_tag = PER
								original_tag = PAL
								original_tag = HAM
								original_tag = HEZ
								original_tag = TUA
								original_tag = SHA
								is_Caucasus = yes
							}
						}
					}
					set_country_flag = middle_east_influencer
				}
				if = {
					limit = {
						any_other_country = {
							no_jihadist_government = yes
							is_top5_influencer = yes
							OR = {
								original_tag = BFA
								original_tag = CHA
								original_tag = MAL
								original_tag = MAU
								original_tag = NIG
								original_tag = NGR
								original_tag = SEN
								original_tag = SUD
								original_tag = SOM
							}
						}
					}
					set_country_flag = africa_influencer
				}
				if = {
					limit = {
						any_other_country = {
							no_jihadist_government = yes
							is_top5_influencer = yes
							OR = {
								original_tag = AFG
								original_tag = KYR
								original_tag = TAJ
								original_tag = TRK
								original_tag = PAK
								original_tag = UZB
							}
						}
					}
					set_country_flag = asia_influencer
				}
			}
			log = "[GetDateText]: [This.GetName]: on_startup init completed"
		}

	}
	on_government_change = {
		effect = {
			every_neighbor_country = {
				clear_neighbor_count_ideas = yes
				set_country_flag = { flag = neighbor_count value = 0 }

					every_neighbor_country = {
						limit = {
							has_government = fascism
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 }
						}
					}

				salafist_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

					every_neighbor_country = {
						limit = {
							has_government = fascism
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				salafist_major_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

					every_neighbor_country = {
						limit = {
							has_government = democratic
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				western_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

					every_neighbor_country = {
						limit = {
							has_government = democratic
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				western_major_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

				every_neighbor_country = {
						limit = {
							has_government = communism
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				emerging_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

					every_neighbor_country = {
						limit = {
							has_government = communism
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				emerging_major_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

				every_neighbor_country = {
						limit = {
							has_government = neutrality
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				non_alligned_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

					every_neighbor_country = {
						limit = {
							has_government = neutrality
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				non_alligned_major_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

				every_neighbor_country = {
						limit = {
							has_government = nationalist
							is_major = no
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				nationalist_count = yes
				clr_country_flag = neighbor_count
				set_country_flag = { flag = neighbor_count value = 0 }

					every_neighbor_country = {
						limit = {
							has_government = nationalist
							is_major = yes
						}
						PREV = { modify_country_flag = { flag = neighbor_count value = 1 } }
					}

				nationalist_major_count = yes
				clr_country_flag = neighbor_count

			}
			clear_own_ideology_drift = yes
			recalculate_law_desires = yes
			### Boost to ruling parties ###
			if = {
				limit = {
					has_government = fascism
					is_major = no
				}
				add_ideas = ruling_party_salafist
			}
			if = {
				limit = {
					has_government = fascism
					is_major = yes
				}
				add_ideas = major_ruling_party_salafist
			}
			if = {
				limit = {
					has_government = democratic
					is_major = no
				}
				add_ideas = ruling_party_western
			}
			if = {
				limit = {
					has_government = democratic
					is_major = yes
				}
				add_ideas = major_ruling_party_western
			}
			if = {
				limit = {
					has_government = communism
					is_major = no
				}
				add_ideas = ruling_party_emerging
			}
			if = {
				limit = {
					has_government = communism
					is_major = yes
				}
				add_ideas = major_ruling_party_emerging
			}
			if = {
				limit = {
					has_government = neutrality
					is_major = no
				}
				add_ideas = ruling_party_non_alligned
			}
			if = {
				limit = {
					has_government = neutrality
					is_major = yes
				}
				add_ideas = major_ruling_party_non_alligned
			}
			if = {
				limit = {
					has_government = nationalist
					is_major = no
				}
				add_ideas = ruling_party_nationalist
			}
			if = {
				limit = {
					has_government = nationalist
					is_major = yes
				}
				add_ideas = major_ruling_party_nationalist
			}
			clear_previous_economic_drift = yes
			if = {
				limit = {
					has_idea = economic_boom
				}
				update_drift_economic_boom = yes
			}
			if = {
				limit = {
					has_idea = fast_growth
				}
				update_drift_fast_growth = yes
			}
			if = {
				limit = {
					has_idea = stagnation
				}
				update_drift_stagnation = yes
			}
			if = {
				limit = {
					has_idea = recession
				}
				update_drift_recession = yes
			}
			if = {
				limit = {
					has_idea = depression
				}
				update_drift_depression = yes
			}
		}
	}

	#Chinese Aggression
	on_puppet = {
		effect = {
			if = {
				limit = { FROM = { tag = CHI } }
				add_to_variable = { chinese_aggression = 5 }
			}
			if = {
				limit = { has_idea = Lacks_International_Recognition }
				swap_ideas = {
					remove_idea = Lacks_International_Recognition
					add_idea = Non_State_Actor
				}
				remove_from_array = {
					global.Unrecognised_States = THIS
				}
			}
			#CT
			if = {
				limit = {
					is_in_array =  { global.ct_states = ROOT }
					FROM = { NOT = { has_idea = sunni }}
				}
				ROOT = {
					add_to_variable = { threat_level = 30 }
					clamp_threat = yes
				}
			}
		}
	}
}
